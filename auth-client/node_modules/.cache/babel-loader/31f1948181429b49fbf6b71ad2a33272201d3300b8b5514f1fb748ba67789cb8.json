{"ast":null,"code":"\n// import { useState, useEffect } from \"react\";\n// import { useNavigate, useParams } from \"react-router-dom\";\n// import axios from \"axios\";\n// import { TextField, Button, Container, Typography, Box, Alert, CircularProgress } from \"@mui/material\";\n\n// const ResetPassword = () => {\n//   const { uidb64, token } = useParams();\n//   const [password, setPassword] = useState(\"\");\n//   const [password2, setPassword2] = useState(\"\");\n//   const [message, setMessage] = useState(\"\");\n//   const [error, setError] = useState(\"\");\n//   const [loading, setLoading] = useState(false);\n//   const [tokenValid, setTokenValid] = useState(null);\n//   const [email, setEmail] = useState(\"\");\n//   const navigate = useNavigate();\n\n//   // Check token validity when component mounts\n//   useEffect(() => {\n//     const checkToken = async () => {\n//       try {\n//         setLoading(true);\n//         const response = await axios.get(\n//           `http://localhost:8000/api/auth/reset-password/${uidb64}/${token}/`\n//         );\n\n//         if (response.data.success) {\n//           setTokenValid(true);\n//           console.log(\"Response data from checkToken:\", response.data);\n//           console.log(\"Email:\", response.data.email);\n//           console.log(\"Token:\", response.data.token);\n//           setEmail(response.data.email);\n//         } else {\n//           setError(response.data.error || \"The reset link is invalid or has expired.\");\n//           setTokenValid(false);\n//         }\n//       } catch (err) {\n//         console.log(\"Error from checkToken:\", err);\n//         setError(\"The reset link is invalid or has expired.\");\n//         setTokenValid(false);\n//       } finally {\n//         setLoading(false);\n//       }\n//     };\n\n//     checkToken();\n//   }, [uidb64, token]);\n\n//   const handleSubmit = async (e) => {\n//     e.preventDefault();\n//     setError(\"\");\n//     setMessage(\"\");\n\n//     if (password !== password2) {\n//       setError(\"Passwords do not match\");\n//       return;\n//     }\n\n//     try {\n//       setLoading(true);\n//       const response = await axios.patch(\n//         \"http://localhost:8000/api/auth/password-reset-complete/\",\n//         { uidb64, token, password, password2 }\n//       );\n\n//       if (response.data.success) {\n//         console.log(\"Password reset successful\", response.data);\n//         setMessage(\"Password reset successfully! Redirecting to login...\");\n//         setTimeout(() => navigate(\"/login\"), 3000);\n//       } else {\n//         console.log(\"Password reset failed\", response.data.error);\n//         setError(response.data.error || \"Password reset failed. Please try again.\");\n//       }\n//     } catch (err) {\n//       console.log(\"Password reset error\", err);\n//       setError(err.response?.data?.error || \"Password reset failed. Please try again.\");\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   if (loading && tokenValid === null) {\n//     return (\n//       <Container maxWidth=\"xs\">\n//         <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n//           <CircularProgress />\n//           <Typography variant=\"body1\" sx={{ mt: 2 }}>\n//             Verifying reset link...\n//           </Typography>\n//         </Box>\n//       </Container>\n//     );\n//   }\n\n//   if (tokenValid === false) {\n//     return (\n//       <Container maxWidth=\"xs\">\n//         <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n//           <Alert severity=\"error\" sx={{ width: '100%', mb: 2 }}>\n//             {error}\n//           </Alert>\n//           <Button \n//             variant=\"contained\" \n//             onClick={() => navigate('/login')}\n//             sx={{ mt: 2 }}\n//           >\n//             Login\n//           </Button>\n//         </Box>\n//       </Container>\n//     );\n//   }\n\n//   return (\n//     <Container maxWidth=\"xs\">\n//       <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\n//         <Typography component=\"h1\" variant=\"h5\">\n//           Reset Password for {email}\n//         </Typography>\n//         {message && (\n//           <Alert severity=\"success\" sx={{ width: '100%', mt: 2 }}>\n//             {message}\n//           </Alert>\n//         )}\n//         {error && (\n//           <Alert severity=\"error\" sx={{ width: '100%', mt: 2 }}>\n//             {error}\n//           </Alert>\n//         )}\n//         <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 1, width: '100%' }}>\n//           <TextField\n//             margin=\"normal\"\n//             required\n//             fullWidth\n//             name=\"password\"\n//             label=\"New Password\"\n//             type=\"password\"\n//             value={password}\n//             onChange={(e) => setPassword(e.target.value)}\n//             inputProps={{ minLength: 8 }}\n//           />\n//           <TextField\n//             margin=\"normal\"\n//             required\n//             fullWidth\n//             name=\"password2\"\n//             label=\"Confirm New Password\"\n//             type=\"password\"\n//             value={password2}\n//             onChange={(e) => setPassword2(e.target.value)}\n//             inputProps={{ minLength: 8 }}\n//           />\n//           <Button\n//             type=\"submit\"\n//             fullWidth\n//             variant=\"contained\"\n//             sx={{ mt: 3, mb: 2 }}\n//             disabled={loading}\n//           >\n//             {loading ? <CircularProgress size={24} /> : \"Reset Password\"}\n//           </Button>\n//         </Box>\n//       </Box>\n//     </Container>\n//   );\n// };\n\n// export default ResetPassword;","map":{"version":3,"names":[],"sources":["C:/Users/ahmed/Desktop/CP/New folder/auth-client/src/pages/ResetPassword.js"],"sourcesContent":["\r\n// import { useState, useEffect } from \"react\";\r\n// import { useNavigate, useParams } from \"react-router-dom\";\r\n// import axios from \"axios\";\r\n// import { TextField, Button, Container, Typography, Box, Alert, CircularProgress } from \"@mui/material\";\r\n\r\n// const ResetPassword = () => {\r\n//   const { uidb64, token } = useParams();\r\n//   const [password, setPassword] = useState(\"\");\r\n//   const [password2, setPassword2] = useState(\"\");\r\n//   const [message, setMessage] = useState(\"\");\r\n//   const [error, setError] = useState(\"\");\r\n//   const [loading, setLoading] = useState(false);\r\n//   const [tokenValid, setTokenValid] = useState(null);\r\n//   const [email, setEmail] = useState(\"\");\r\n//   const navigate = useNavigate();\r\n\r\n//   // Check token validity when component mounts\r\n//   useEffect(() => {\r\n//     const checkToken = async () => {\r\n//       try {\r\n//         setLoading(true);\r\n//         const response = await axios.get(\r\n//           `http://localhost:8000/api/auth/reset-password/${uidb64}/${token}/`\r\n//         );\r\n        \r\n//         if (response.data.success) {\r\n//           setTokenValid(true);\r\n//           console.log(\"Response data from checkToken:\", response.data);\r\n//           console.log(\"Email:\", response.data.email);\r\n//           console.log(\"Token:\", response.data.token);\r\n//           setEmail(response.data.email);\r\n//         } else {\r\n//           setError(response.data.error || \"The reset link is invalid or has expired.\");\r\n//           setTokenValid(false);\r\n//         }\r\n//       } catch (err) {\r\n//         console.log(\"Error from checkToken:\", err);\r\n//         setError(\"The reset link is invalid or has expired.\");\r\n//         setTokenValid(false);\r\n//       } finally {\r\n//         setLoading(false);\r\n//       }\r\n//     };\r\n    \r\n//     checkToken();\r\n//   }, [uidb64, token]);\r\n\r\n//   const handleSubmit = async (e) => {\r\n//     e.preventDefault();\r\n//     setError(\"\");\r\n//     setMessage(\"\");\r\n\r\n//     if (password !== password2) {\r\n//       setError(\"Passwords do not match\");\r\n//       return;\r\n//     }\r\n\r\n//     try {\r\n//       setLoading(true);\r\n//       const response = await axios.patch(\r\n//         \"http://localhost:8000/api/auth/password-reset-complete/\",\r\n//         { uidb64, token, password, password2 }\r\n//       );\r\n      \r\n//       if (response.data.success) {\r\n//         console.log(\"Password reset successful\", response.data);\r\n//         setMessage(\"Password reset successfully! Redirecting to login...\");\r\n//         setTimeout(() => navigate(\"/login\"), 3000);\r\n//       } else {\r\n//         console.log(\"Password reset failed\", response.data.error);\r\n//         setError(response.data.error || \"Password reset failed. Please try again.\");\r\n//       }\r\n//     } catch (err) {\r\n//       console.log(\"Password reset error\", err);\r\n//       setError(err.response?.data?.error || \"Password reset failed. Please try again.\");\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   if (loading && tokenValid === null) {\r\n//     return (\r\n//       <Container maxWidth=\"xs\">\r\n//         <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n//           <CircularProgress />\r\n//           <Typography variant=\"body1\" sx={{ mt: 2 }}>\r\n//             Verifying reset link...\r\n//           </Typography>\r\n//         </Box>\r\n//       </Container>\r\n//     );\r\n//   }\r\n\r\n//   if (tokenValid === false) {\r\n//     return (\r\n//       <Container maxWidth=\"xs\">\r\n//         <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n//           <Alert severity=\"error\" sx={{ width: '100%', mb: 2 }}>\r\n//             {error}\r\n//           </Alert>\r\n//           <Button \r\n//             variant=\"contained\" \r\n//             onClick={() => navigate('/login')}\r\n//             sx={{ mt: 2 }}\r\n//           >\r\n//             Login\r\n//           </Button>\r\n//         </Box>\r\n//       </Container>\r\n//     );\r\n//   }\r\n\r\n//   return (\r\n//     <Container maxWidth=\"xs\">\r\n//       <Box sx={{ mt: 8, display: 'flex', flexDirection: 'column', alignItems: 'center' }}>\r\n//         <Typography component=\"h1\" variant=\"h5\">\r\n//           Reset Password for {email}\r\n//         </Typography>\r\n//         {message && (\r\n//           <Alert severity=\"success\" sx={{ width: '100%', mt: 2 }}>\r\n//             {message}\r\n//           </Alert>\r\n//         )}\r\n//         {error && (\r\n//           <Alert severity=\"error\" sx={{ width: '100%', mt: 2 }}>\r\n//             {error}\r\n//           </Alert>\r\n//         )}\r\n//         <Box component=\"form\" onSubmit={handleSubmit} sx={{ mt: 1, width: '100%' }}>\r\n//           <TextField\r\n//             margin=\"normal\"\r\n//             required\r\n//             fullWidth\r\n//             name=\"password\"\r\n//             label=\"New Password\"\r\n//             type=\"password\"\r\n//             value={password}\r\n//             onChange={(e) => setPassword(e.target.value)}\r\n//             inputProps={{ minLength: 8 }}\r\n//           />\r\n//           <TextField\r\n//             margin=\"normal\"\r\n//             required\r\n//             fullWidth\r\n//             name=\"password2\"\r\n//             label=\"Confirm New Password\"\r\n//             type=\"password\"\r\n//             value={password2}\r\n//             onChange={(e) => setPassword2(e.target.value)}\r\n//             inputProps={{ minLength: 8 }}\r\n//           />\r\n//           <Button\r\n//             type=\"submit\"\r\n//             fullWidth\r\n//             variant=\"contained\"\r\n//             sx={{ mt: 3, mb: 2 }}\r\n//             disabled={loading}\r\n//           >\r\n//             {loading ? <CircularProgress size={24} /> : \"Reset Password\"}\r\n//           </Button>\r\n//         </Box>\r\n//       </Box>\r\n//     </Container>\r\n//   );\r\n// };\r\n\r\n// export default ResetPassword;"],"mappings":";AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}